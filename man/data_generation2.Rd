% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_generation.R
\name{data_generation2}
\alias{data_generation2}
\title{Single-dataset simulation with given conjunction level L}
\usage{
data_generation2(
  m = 100000L,
  K = 5L,
  m1 = 300L,
  L = 5L,
  se = 0.3,
  flip_prob = 0.5,
  flip_within_L = TRUE,
  use_corr_noise = TRUE,
  rho_cor_noise = 0.8,
  seed = NULL
)
}
\arguments{
\item{m}{Total number of SNPs (rows). Default \code{100000}.}

\item{K}{Total number of traits (columns). Default \code{5}.}

\item{m1}{Number of causal SNPs (first \code{m1} rows). Default \code{300}.}

\item{L}{Conjunction level: number of traits (among the first \code{K})
that carry a non-zero effect. Typically \code{1 <= L <= K}. Default \code{5}.}

\item{se}{Scalar standard error for marginal noise. Default \code{0.3}.}

\item{flip_prob}{Probability of flipping the sign of each added effect entry
(controls sign heterogeneity). Default \code{0.5}. Set to \code{0} to
disable sign flipping.}

\item{flip_within_L}{Logical; if \code{TRUE}, the sign-flip mask is generated
only on the first \code{L} traits; if \code{FALSE}, it is generated on all
\code{K} traits (effects are still only added in the first \code{L} traits).
Default \code{TRUE}.}

\item{use_corr_noise}{Logical; if \code{TRUE}, the first \code{L} traits
receive equicorrelated noise with correlation \code{rho_cor_noise}.
Otherwise, all traits use independent noise with variance \code{se^2}.
Default \code{TRUE}.}

\item{rho_cor_noise}{Scalar correlation used for the equicorrelated noise
among the first \code{L} traits. Default \code{0.8}.}

\item{seed}{Optional integer random seed for reproducibility. If
\code{NULL}, the current RNG state is used. Default \code{NULL}.}
}
\value{
A list with components:
\describe{
\item{BetaHat}{An \code{m x K} matrix of observed effects.}
\item{S}{An \code{m x K} matrix of standard errors.}
\item{L}{The conjunction level used.}
\item{m,K,m1,se}{Basic design parameters.}
\item{traits_lab}{Character vector of trait names.}
\item{is_causal}{Length-\code{m} indicator vector (1 for causal rows).}
\item{beta_star}{Length-\code{m1} vector of latent effect sizes reused
across the first \code{L} traits.}
\item{flip_prob,flip_within_L,use_corr_noise,rho_cor_noise,seed}{The
control parameters actually used.}
}
}
\description{
\code{data_generation2()} generates a single simulated dataset for a given
conjunction level \code{L}. The first \code{L} traits carry non-zero effects
among the first \code{m1} rows, under a flattop prior, with optional sign
heterogeneity and optional equicorrelated noise among the first \code{L}
traits.
}
\details{
This design is useful when you want one clean dataset at a specific
conjunction level (e.g. \code{L = 5, 4, 3, 2, 1}) without additional
replicates.
}
