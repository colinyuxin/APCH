% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em_interface.R
\name{block_decompose}
\alias{block_decompose}
\title{Block-diagonal decomposition of a symmetric matrix}
\usage{
block_decompose(A, tau = 1e-04)
}
\arguments{
\item{A}{Symmetric numeric matrix.}

\item{tau}{Numeric threshold; entries with \eqn{|A_{ij}| \le \tau} are set to
zero before forming the adjacency matrix. Default: \code{1e-4}.}
}
\value{
A list with components:
\describe{
\item{num_blocks}{Number of blocks (connected components).}
\item{blocks}{List of block submatrices of \code{A}.}
\item{indices}{List of integer index vectors, one per block.}
}
}
\description{
Given a symmetric matrix \code{A}, threshold small entries to zero and treat
the result as the adjacency matrix of an undirected graph. Connected
components of this graph define (approximate) diagonal blocks of \code{A}.
}
\details{
This helper is used to exploit near-block-diagonal structure in the global
noise matrix \code{R_cor} for Stage A, then fuse blocks in Stage B.
}
\keyword{internal}
