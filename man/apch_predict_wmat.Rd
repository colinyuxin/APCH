% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apch_predict.R
\name{apch_predict_wmat}
\alias{apch_predict_wmat}
\title{Predict configuration posterior weights for new data}
\usage{
apch_predict_wmat(
  res,
  B,
  S,
  C,
  mixcompdist = "normal",
  tau_block = 1e-04,
  progress_chunk = 128L,
  use_parallel = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{res}{A fitted APCH object returned by \code{apch_workhorse()} with
\code{mode = "meta"} and \code{force_one_block = FALSE}. It must contain
\code{res$ashr_res}, \code{res$config_res$stageA}, and
\code{res$config_res$stageB$delta}.}

\item{B}{Numeric matrix of new effect estimates (\eqn{n_{\mathrm{new}} \times p}).
Columns (features) must match those used in the original fit (same order).}

\item{S}{Numeric matrix of new standard errors (same dimensions as \code{B}).}

\item{C}{Numeric \eqn{p \times p} correlation (or covariance) matrix for the
new data. This should match the matrix used in the original fit, at least
up to block structure (same thresholding \code{tau_block}).}

\item{mixcompdist}{Slab family used in the original fit (e.g. \code{"normal"},
\code{"uniform"}). This is passed to the Stage-A prediction C++ routine.
Default: \code{"normal"}.}

\item{tau_block}{Numeric threshold used for block decomposition of \code{C}.
Must be the same value as used in the original fit (default \code{1e-4}).}

\item{progress_chunk}{Integer chunk size for Stage-A likelihood computation
in the C++ predictor. Default: \code{128}.}

\item{use_parallel}{Logical; whether to allow C++ parallelisation via
\pkg{RcppParallel}. Default: \code{TRUE}.}

\item{verbose}{Logical; print progress and diagnostics. Default: \code{TRUE}.}
}
\value{
A numeric matrix \code{w_mat} of size
\eqn{n_{\mathrm{new}} \times 2^p}, where each row contains posterior
configuration weights (PPA over all binary feature-activation patterns)
for a new effect. Row names are copied from \code{B} (if present); column
names are binary strings representing configurations in the original
feature order.
}
\description{
Given a fitted APCH model (the full output from \code{apch_workhorse()})
and new summary statistics \code{B}, \code{S} with the same set and order
of features, reuse the configuration-layer parameters (Stage-A block weights
and Stage-B global configuration probabilities \code{delta}) to compute
posterior configuration weights for the new data.
}
\details{
This function is intended for the meta-analysis setting with
\code{force_one_block = FALSE}, i.e. the configuration layer used
block-diagonal decomposition in Stage A and then fused blocks in
Stage B via MCMC or EM/mixsqp. It assumes that the new noise correlation
matrix \code{C} is the same as (or compatible with) the one used at fit
time, so that the block structure is unchanged.
}
