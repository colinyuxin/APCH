% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_all_feature.R
\name{fit_all_feature}
\alias{fit_all_feature}
\title{Fit Adaptive Shrinkage Models for All Features}
\usage{
fit_all_feature(
  X,
  S,
  mixcompdist = "normal",
  lambda0 = 10,
  fine_s_min_mult = 0.5,
  fine_s_max_mult = 1,
  fine_mult_distill = 1.35,
  fine_mult_nodistill = sqrt(2),
  fine_max_len = 500,
  mixsqp_control = NULL,
  mll_drop_total_tol = 2e-04,
  ks_increase_total_tol = 0.01,
  min_grid_len = 3,
  max_merges = Inf,
  pair_frac = 0.2,
  rel_thresh = 1e-06,
  distill = "auto",
  R_cor = NULL,
  cor_thresh = sqrt(.Machine$double.eps),
  workers = max(1L, parallel::detectCores(logical = TRUE) - 1L),
  plan = NULL,
  future_seed = TRUE,
  future_scheduling = 1,
  output = c("light", "full"),
  verbose = TRUE
)
}
\arguments{
\item{X}{A numeric matrix of observed effects (n Ã— p).}

\item{S}{A numeric matrix of standard errors (same dimensions as \code{X}).}

\item{mixcompdist}{Character; mixture component distribution
(\code{"normal"} by default).}

\item{lambda0}{Regularization parameter for mixture prior.}

\item{fine_s_min_mult, fine_s_max_mult}{Numeric multipliers controlling the
range of scale parameters for fine grids.}

\item{fine_mult_distill, fine_mult_nodistill}{Numeric multipliers controlling
the fine-grid step size for features selected for distillation and for
non-distilled features, respectively. These are passed as \code{fine_mult}
to \code{distill_grid_path_from_xs()}. Default: \code{1.35} and
\code{sqrt(2)}.}

\item{fine_max_len}{Integer; maximum grid length.}

\item{mixsqp_control}{Control list for \code{mixsqp} optimization.}

\item{mll_drop_total_tol, ks_increase_total_tol}{Convergence tolerance
parameters for grid refinement.}

\item{min_grid_len, max_merges}{Integer limits controlling grid merging
behavior.}

\item{pair_frac}{Fraction of grid pairs allowed to merge at each step.}

\item{rel_thresh}{Relative tolerance for grid merging.}

\item{distill}{Logical or \code{"auto"}; enables grid simplification.}

\item{R_cor}{Optional correlation matrix among features.}

\item{cor_thresh}{Correlation threshold for distillation selection.}

\item{workers}{Number of parallel workers.}

\item{plan}{Parallelization plan (\code{"multicore"} or \code{"multisession"}).}

\item{future_seed}{Logical; whether to use reproducible random seeds in futures.}

\item{future_scheduling}{Chunk scheduling ratio for parallel tasks.}

\item{output}{Either \code{"light"} or \code{"full"}, controlling result
verbosity.}

\item{verbose}{Logical; print diagnostic messages.}
}
\value{
A list containing:
\describe{
\item{signed_grids}{List of signed mixture grids for each feature.}
\item{pi_list}{List of mixture weights for each feature.}
\item{fit_res}{(If \code{output="full"}) Full fit results for each feature.}
}
}
\description{
The \code{fit_all_feature()} function performs independent adaptive shrinkage
(via \code{ashr}) across multiple features, possibly in parallel. It fits
mixture distributions to the observed data and optionally performs grid
distillation to simplify posterior grids.
}
