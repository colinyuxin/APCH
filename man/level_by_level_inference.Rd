% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apch_inference.R
\name{level_by_level_inference}
\alias{level_by_level_inference}
\title{Level-by-Level Inference for Partial Conjunction Hypotheses}
\usage{
level_by_level_inference(
  w_mat,
  configs,
  alpha = 0.05,
  null_th = 0.9,
  ppa_min = 0.5,
  feature_names = NULL
)
}
\arguments{
\item{w_mat}{Matrix of normalized posterior weights (n × K), where each row
sums to 1.}

\item{configs}{Binary configuration matrix (K × p), representing all possible
feature activation patterns.}

\item{alpha}{Significance level for false discovery rate control.}

\item{null_th}{Posterior probability threshold for null acceptance.}

\item{ppa_min}{Minimum posterior probability required to report a call.}

\item{feature_names}{Optional vector of feature names.}
}
\value{
A list containing:
\describe{
\item{calls}{Data frame of detected conjunctions, including effect name,
level \code{L}, local FDR, and subset indicators.}
\item{est_fdr}{Estimated overall false discovery rate.}
}
}
\description{
The \code{level_by_level_inference()} function performs multi-level inference
on posterior mixture weights obtained from the APCH model. It determines which
effects (rows) are active across subsets of features at varying conjunction
levels.
}
\examples{
\dontrun{
lvl_res <- level_by_level_inference(
  w_mat = w_mat,
  configs = configs,
  alpha = 0.05,
  null_th = 0.9,
  ppa_min = 0.5,
  feature_names = paste0("F", 1:p)
)

cat("Calls returned:", nrow(lvl_res$calls), "\n")
head(lvl_res$calls)
}

}
