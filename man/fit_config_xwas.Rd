% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em_interface.R
\name{fit_config_xwas}
\alias{fit_config_xwas}
\title{Configuration layer: xwas / per-effect covariance (no penalty)}
\usage{
fit_config_xwas(
  X,
  S,
  C_list,
  sgL,
  piL = NULL,
  configs,
  mixcompdist = "normal",
  max_iter_A = 1e+06,
  tol_A = 1e-06,
  max_iter_B = 1e+06,
  tol_B = 1e-06,
  progress = interactive(),
  progress_chunk = 128,
  use_parallel = TRUE,
  n_threads = parallel::detectCores(logical = TRUE),
  verbose = TRUE,
  output = c("full", "light"),
  solver_stageA = c("mixsqp", "em", "loglinear"),
  solver_stageB = c("mcmc", "mixsqp", "em", "loglinear"),
  stageA_ll_tol = 0.01,
  stageB_ll_tol = 0.01
)
}
\arguments{
\item{X}{Numeric matrix of observed effects (\eqn{n \times p}).}

\item{S}{Numeric matrix of standard errors (same as \code{X}).}

\item{C_list}{List of length \code{n}; per-effect \eqn{p \times p} matrices.}

\item{sgL}{List of length \code{p}; signed mixture grid per feature.}

\item{piL}{Optional list of length \code{p}; weights per feature (kept for API symmetry).}

\item{configs}{Binary configuration matrix (\eqn{K \times p}) of all patterns.}

\item{mixcompdist}{Slab family (e.g. \code{"normal"}).}

\item{max_iter_A, tol_A}{Stage-A iteration limit and tolerance for EM/mixsqp.
For \code{"loglinear"} Stage A, \code{tol_A} is ignored and
\code{stageA_ll_tol} is used instead.}

\item{max_iter_B, tol_B}{Stage-B iteration limit and tolerance for EM/mixsqp.
For Stage-B \code{"loglinear"}, \code{tol_B} is ignored and
\code{stageB_ll_tol} is used instead.}

\item{progress}{Logical; Stage-A progress flag.}

\item{progress_chunk}{Integer chunk size for Stage-A likelihood precomputation.}

\item{use_parallel}{Logical; enable multi-threading in C++ backends.}

\item{n_threads}{Max threads for \pkg{RcppParallel} (capped to 8).}

\item{verbose}{Logical; print diagnostics.}

\item{output}{Either \code{"full"} (return Stage A/B details) or
\code{"light"} (only \code{w_mat} and \code{delta}).}

\item{solver_stageA}{\code{"mixsqp"} (default), \code{"em"}, or
\code{"loglinear"} for Stage A.}

\item{solver_stageB}{\code{"mcmc"} (default), \code{"mixsqp"}, \code{"em"},
or \code{"loglinear"}.}

\item{stageA_ll_tol}{Tolerance for Stage-A \code{"loglinear"} solver
(default \code{0.01}); ignored by other Stage-A solvers.}

\item{stageB_ll_tol}{Tolerance for Stage-B \code{"loglinear"} solver
(default \code{0.01}); ignored by other Stage-B solvers.}
}
\value{
A list:
\describe{
\item{w_mat}{Posterior configuration weights (\eqn{n \times K}).}
\item{delta}{Global configuration probabilities (length \eqn{K}).}
\item{stageA, stageB, block_logf}{(When \code{output="full"}) internals.}
}
}
\description{
Stage A is performed on all features as a single block but allowing
per-effect covariance matrices \code{C_i}. Stage B then fuses
sub-configurations exactly as in the meta-analysis case.
}
\details{
The solvers for Stage A and Stage B are controlled by \code{solver_stageA}
and \code{solver_stageB}, respectively. No EB/size penalty is used in Stage B.
\code{solver_stageB} also supports \code{"loglinear"} (Ising + ridge) and
Stage A supports a \code{"loglinear"} softmax+L2 solver on the block-level
mixture over \eqn{\eta}-patterns, controlled by \code{stageA_ll_tol}.
}
\keyword{internal}
